# 記帳頁面重新設計方案

## 📊 問題診斷

### 當前設計的複雜度問題

1. **資訊過載**
   - 頂部快速輸入 + Sticky Header (3層) + 統計圖表 + 列表 = 螢幕塞滿
   - Sticky 元素堆疊高度超過 200px，嚴重壓縮內容空間
   - 空白利用率差，手機版尤其明顯

2. **功能重複**
   - 快速記帳的「常用分類」vs. Header 的「分類篩選」
   - 5 種視圖模式（日/週/月/年/月曆）過於複雜
   - 月曆視圖和列表視圖割裂，無法同時查看

3. **互動流程混亂**
   - 記帳有兩條路徑：快速輸入(Enter) vs. 表單(+按鈕)
   - 統計圖表 Toggle、Header 收合動畫，增加認知負擔
   - 編輯功能隱藏在 hover 狀態，不易發現

4. **視覺層級不清**
   - 所有元素爭奪注意力
   - 缺乏清晰的主要動線
   - 顏色使用過多（sage/rose/blue/sand 同時出現）

---

## 🎯 設計原則

1. **極簡主義**：移除非核心功能，保留 80% 使用場景
2. **單一職責**：每個區塊只做一件事
3. **視覺呼吸**：增加留白，降低資訊密度
4. **行動優先**：確保手機版流暢體驗

---

## ✨ 改進方案

### Phase 1: 簡化 Header 結構 ⭐ 優先

**Before:**
```
[快速輸入框 - 120px]
[視圖切換器 - 40px]  ← 收合時隱藏
[日期導航 + 按鈕 - 50px]
[分類篩選器 - 40px]  ← 收合時隱藏
= 總計 250px (展開) / 130px (收合)
```

**After:**
```
[快速輸入框 - 70px]   ← 精簡為單行，移除常用分類按鈕
[日期導航 - 50px]     ← 永久顯示，內嵌模式切換
= 總計 120px (固定)
```

**具體改動：**
- ❌ 移除 5 種視圖 → ✅ 只保留「月/年」兩種
- ❌ 移除分類篩選器 → ✅ 整合到統計卡片內
- ❌ 移除 Header 收合動畫 → ✅ 固定高度不變
- ❌ 移除常用分類快捷按鈕 → ✅ 改為編輯時智能建議

---

### Phase 2: 優化快速記帳流程

**Before:**
- 輸入框 + 常用分類 3 個按鈕 + 「更多選項」按鈕
- 使用者需要在「快速」vs.「完整」流程間選擇

**After:**
- 輸入框 **單行** 設計（輸入金額按 Enter 即記錄）
- 預設分類：自動使用上次記帳的分類
- 點擊任一交易記錄 → 直接進入編輯模式（而非 hover 顯示按鈕）

**用戶流程簡化：**
```
舊流程: 輸入 → 選分類 → Enter → 記錄
新流程: 輸入 → Enter → 記錄 (智能分類)
```

---

### Phase 3: 統一視覺層級

**Before:**
- 統計圖表可收合（預設展開）
- 圖表高度 250px + 控制按鈕
- 月曆視圖獨立頁面

**After:**
- 統計卡片精簡為 **3 個數字** (收入/支出/結餘)
- 圖表改為 **小型趨勢線**（高度 120px，永久顯示）
- ❌ 移除月曆視圖 → ✅ 點擊日期跳轉到該日列表

**資訊層級：**
```
1. 快速輸入 (最常用)     ← 頂部固定
2. 統計數字 + 趨勢圖    ← 一屏可見
3. 交易列表             ← 主要內容
```

---

### Phase 4: 改進 Mobile 體驗

**Before:**
- Sticky 堆疊 200px+
- 月曆格子 aspect-square，手機上太小
- 統計圖表被收合時難以找回

**After:**
- Sticky 總高度控制在 **120px**
- 列表卡片加大觸控面積（min-height: 60px）
- 統計卡片改為 **橫向滑動** (Swiper)
- 簡化動畫效果（減少 transform/backdrop-blur）

---

## 📐 實作細節

### 新版 Ledger 結構

```tsx
<Ledger>
  {/* 1. 快速輸入 - Sticky Top 70px */}
  <QuickInput 
    placeholder="輸入金額按 Enter（例如：120）" 
    onEnter={handleQuickAdd}
  />
  
  {/* 2. 日期導航 - Sticky Top 120px */}
  <DateNav
    mode={mode}              // 'month' | 'year'
    currentDate={currentDate}
    onPrev={handlePrev}
    onNext={handleNext}
    onModeToggle={toggleMode}
  />
  
  {/* 3. 統計卡片 - 非 Sticky */}
  <StatsCards
    income={summary.income}
    expense={summary.expense}
    balance={summary.balance}
  />
  
  {/* 4. 趨勢圖 - 精簡版 */}
  <MiniTrendChart data={chartData} height={120} />
  
  {/* 5. 交易列表 - 點擊直接編輯 */}
  <TransactionList
    transactions={groupedTransactions}
    onEdit={handleEdit}
    onDelete={handleDelete}
  />
  
  {/* 6. 編輯 Modal */}
  {isModalOpen && <EditModal ... />}
</Ledger>
```

### 顏色簡化

**Before:** 4 種主題色同時使用
- morandi-sage (收入)
- morandi-rose (支出)
- morandi-blue (結餘/導航)
- morandi-sand (背景)

**After:** 只用 2 種
- morandi-blue (主色，用於所有互動元素)
- morandi-rose (警示色，用於支出/刪除)
- 收入改用 `text-ink-900` 深色顯示（不用綠色）

---

## 🎨 視覺對比

### Before (複雜)
```
┌─────────────────────────┐
│ 快速輸入 + 3個分類按鈕   │ ← 120px
├─────────────────────────┤
│ 日/週/月/年/月曆 切換器  │ ← 40px (收合時隱藏)
├─────────────────────────┤
│ ◀ 2024年11月 ▶  圖 +    │ ← 50px
├─────────────────────────┤
│ 全部 飲食 購物 交通 ...  │ ← 40px (收合時隱藏)
├─────────────────────────┤
│ [$收入] [$支出] [$結餘]  │ ← 100px
│ [收支趨勢長條圖]         │ ← 250px
├─────────────────────────┤
│ 11/24 交易1 交易2       │
│ 11/23 交易3             │
└─────────────────────────┘
Total: 600px 才看到交易記錄
```

### After (簡潔)
```
┌─────────────────────────┐
│ 輸入金額按 Enter ⏎      │ ← 70px
├─────────────────────────┤
│ ◀ 2024年11月 ▶ [月/年]  │ ← 50px
├─────────────────────────┤
│ [$收入] [$支出] [$結餘]  │ ← 80px
│ [趨勢線圖 - 精簡版]     │ ← 120px
├─────────────────────────┤
│ 11/24 交易1 交易2       │ ← 直接編輯
│ 11/23 交易3             │
└─────────────────────────┘
Total: 320px 即可看到內容
```

---

## 📊 改進指標

| 指標 | Before | After | 改善 |
|------|--------|-------|------|
| Sticky 高度 | 250px | 120px | **-52%** |
| 首屏交易數 | 1-2 筆 | 4-5 筆 | **+150%** |
| 記帳步驟 | 3 步 | 2 步 | **-33%** |
| 視圖模式 | 5 種 | 2 種 | **-60%** |
| 主要顏色 | 4 種 | 2 種 | **-50%** |

---

## 🚀 實作優先級

### P0 - 立即改進 (影響最大)
- [x] 移除視圖切換器（日/週/月曆）
- [ ] 精簡快速輸入框（移除常用分類）
- [ ] 統一 Sticky 高度為 120px

### P1 - 短期優化 (一週內)
- [ ] 統計圖表改為趨勢線（高度 120px）
- [ ] 點擊交易直接編輯（不用 hover）
- [ ] 移除分類篩選器

### P2 - 長期優化 (兩週內)
- [ ] Mobile 觸控優化（加大按鈕）
- [ ] 顏色系統簡化
- [ ] 動畫效果減少（提升性能）

---

## 💡 額外建議

1. **搜尋功能**：考慮加入「搜尋交易」而非分類篩選
2. **批量操作**：長按多選 → 批量刪除/編輯
3. **智能建議**：根據時間/地點自動建議分類
4. **週期性記帳**：固定支出（房租/訂閱）自動記錄

---

## 🎯 成功標準

改版成功的 3 個指標：
1. 使用者能在 **2 秒內** 完成記帳（輸入→Enter）
2. 首屏能看到 **至少 4 筆** 交易記錄
3. 手機版 Sticky 高度 **不超過 120px**

---

**結論：**  
目前設計功能齊全但過於複雜。通過減少 40% 的功能，可以提升 100% 的使用效率。
用戶真正需要的是：**快速記帳 + 清晰概覽**，而不是複雜的視圖和篩選器。
